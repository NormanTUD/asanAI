<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate AI Lab v4.4 - No Recursion & Stable Viz</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>window.MathJax = { tex: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']] } };</script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="fcnn_visualization.js"></script>
    <script src="init.js"></script>
    <script src="helper.js"></script>
    <script src="visionlab.js"></script>
    <script src="train.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="card">
    <h2>0. Minimales Neuron Lab</h2>
    <div class="grid-layout">
        <div class="layers-vertical">
            <div class="layer-box" style="border-color:#10b981"><span class="layer-badge">INPUT</span>1 Node (x)</div>
            <div class="layer-box" style="border-color:#8b5cf6"><span class="layer-badge">OUTPUT</span>1 Node (y)</div>
            LR: <input type="number" id="lin-lr" value="0.1" step="0.01">
            Epochs: <input type="number" id="lin-epochs" value="100">
        </div>
        <div>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <div id="lin-loss-chart" class="plot-container"></div>
                <div id="lin-data-chart" class="plot-container"></div>
            </div>
            <div id="lin-math-monitor" style="padding:15px; margin-top:10px;"></div>
            <button id="btn-lin-train" class="btn btn-train" onclick="toggleTraining('lin')">ðŸš€ Training Starten</button>
            <button class="btn" style="background:#64748b; color:white; width:100%" onclick="initBlock('lin')">ðŸ”„ Reset Modell</button>
            <div id="lin-console" class="status-console"></div>
        </div>
    </div>
</div>
<div class="card">
    <h3>1. Statistik: Normalverteilung</h3>
    <div style="text-align: center; margin-bottom: 10px; font-size: 1.1rem;">
        $$ f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2} $$
    </div>
    <div id="gauss-chart" style="height:250px; width:100%;"></div>
</div>
<div class="card" id="vision-lab">
	<div class="md">
## 2. Vision Lab
Dieses Modul zeigt, wie **Convolutional Neural Networks** Kanten erkennen.
* **Sharpen:** Hebt Kontraste hervor.
* **Blur:** GlÃ¤ttet das Bild.
> **Hinweis:** Bewege die Maus Ã¼ber das Quellbild, um die Matrix-Multiplikation live zu sehen.
	</div>
    <h2>2. Vision Lab (Convolution & Matrix)</h2>
    <div style="margin-bottom: 15px; display: flex; gap: 8px; flex-wrap: wrap;">
        <button class="btn" onclick="setKernel([[0,-1,0],[-1,5,-1],[0,-1,0]])">Sharpen</button>
        <button class="btn" onclick="setKernel([[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]])">Blur</button>
        <button class="btn" onclick="setKernel([[-1,-1,-1],[-1,8,-1],[-1,-1,-1]])">Edge</button>
        <button class="btn" onclick="setKernel([[0,0,0],[0,1,0],[0,0,0]])">Identity</button>
	<button class="btn" onclick="setKernel([[-1,-2,-1],[0,0,0],[1,2,1]])">Sobel H</button>
	<button class="btn" onclick="setKernel([[-1,0,1],[-2,0,2],[-1,0,1]])">Sobel V</button>
	<button class="btn" onclick="setKernel([[-2,-1,0],[-1,1,1],[0,1,2]])">Emboss</button>
	<button class="btn" onclick="setKernel([[1/16,2/16,1/16],[2/16,4/16,2/16],[1/16,2/16,1/16]])">Gaussian</button>
    </div>
    <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
        <div style="position: relative; line-height: 0; display: inline-block;">
            <b style="line-height: 1.5; display: block;">Original (Hover me!)</b>
            <canvas id="conv-src-display" class="vision-canvas" width="50" height="50" style="cursor: none; border: 1px solid #ccc;"></canvas>
            <div id="conv-focus" style="position: absolute; border: 2px solid red; pointer-events: none; display: none; box-sizing: border-box; z-index: 10;"></div>
        </div>
        <div>
            <b>Filter Kernel</b><br>
            GrÃ¶ÃŸe: <input type="number" id="k-size" value="3" min="1" max="5" step="2" onchange="initVisionLab()">
            <table id="kernel-table" style="margin-top: 10px; border-collapse: collapse;"></table>
        </div>
        <div id="conv-res-container" style="position: relative; line-height: 0; display: inline-block;">
            <b style="line-height: 1.5; display: block;">Filtered Result</b>
            <canvas id="conv-res" class="vision-canvas" width="50" height="50" style="border: 1px solid #ccc;"></canvas>
            <div id="conv-crosshair" style="position: absolute; pointer-events: none; display: none; z-index: 10;">
                <div style="position: absolute; width: 10px; height: 2px; background: red; left: -5px; top: -1px;"></div>
                <div style="position: absolute; width: 2px; height: 10px; background: red; left: -1px; top: -5px;"></div>
            </div>
        </div>
    </div>
    <div id="conv-math-step" style="margin-top: 20px; padding: 15px; background: #f8fafc; border: 1px solid #cbd5e0; border-radius: 8px; font-size: 0.85rem; overflow-x: auto; min-height: 100px;">
        Bewege die Maus Ã¼ber das Bild...
    </div>
    <img id="conv-src-hidden" src="https://picsum.photos/id/20/50/50" crossorigin="anonymous" style="display:none">
    <div id="visionlab-console" class="status-console"></div>
</div>
<div class="card">
    <h2>3. Deep Learning Lab</h2>
    <div style="margin-bottom: 15px; display: flex; gap: 10px;">
        <button class="btn" onclick="loadPreset('AND')">AND</button>
        <button class="btn" onclick="loadPreset('XOR')">XOR</button>
        LR: <input type="number" id="deep-lr" value="0.05" step="0.01">
        Epochs: <input type="number" id="deep-epochs" value="100">
    </div>
    <div class="grid-layout">
        <div id="deep-gui" class="layers-vertical"></div>
        <div>
            <div id="fcnn_wrapper">
                <canvas id="fcnn_canvas"></canvas>
            </div>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <div id="deep-loss-chart" class="plot-container"></div>
                <div id="deep-data-chart" class="plot-container"></div>
            </div>
            <div style="margin-top: 10px;">
                <b>Weights (Live):</b>
                <div id="deep-tensor-viz" style="display:flex; gap:5px; flex-wrap: wrap;"></div>
            </div>
            <div id="deep-math-monitor" style="padding:15px; margin-top:10px;"></div>
            <table id="deep-train-table">
                <thead><tr id="deep-thr"></tr></thead>
                <tbody></tbody>
            </table>
            <button class="btn" style="background:#10b981; color:white; width:100%" onclick="addRow('deep')">+ Neue Datenzeile</button>
            <div style="background: #fef3c7; padding: 15px; border-radius: 8px; margin-top:10px;">
                <div id="manual-input-area" style="display:inline-block; margin: 0 10px;"></div>
                <span>â†’ <strong id="manual-result" style="color:#b45309">0.00</strong></span>
            </div>
            <button id="btn-deep-train" class="btn btn-train" onclick="toggleTraining('deep')">ðŸš€ Training Starten</button>
            <button class="btn" style="background:#64748b; color:white; width:100%" onclick="initBlock('deep')">ðŸ”„ Reset Modell</button>
            <div id="deep-console" class="status-console"></div>
        </div>
    </div>
</div>
</body>
</html>
